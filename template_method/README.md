# 模板方法模式(Template Method Pattern)

模板方法模式在一个方法中定义一个算法框架，并将某些步骤推迟到子类中实现；模板方法模式可以让子类在不改变算法整体结构的情况下，重新定义算法中的某些步骤。

模板方法模式通过定义一个模板方法来控制算法的执行流程，而具体的步骤实现则由子类来完成。

模板方法模式主要用来解决`复用`和`扩展`两个问题。

模版方法模式使用继承机制，把通用步骤和通用方法放到父类中，把具体实现延迟到子类中实现，使得实现符合开闭原则。

因为Golang不提供继承机制，需要使用`匿名组合模拟实现继承`。需要注意的是，因为父类需要调用子类方法，所以子类需要匿名组合父类的同时，父类需要持有子类的引用。

## 核心思想

将算法的骨架固定下来，而将具体步骤的实现交给子类。这样可以确保算法的结构不变，同时允许子类根据自身需求进行具体步骤的实现。

模板方法模式由两个主要组件组成：
- 抽象类（Abstract Class）：定义了算法的骨架，包含一个或多个模板方法以及一些抽象方法，用于延迟到子类实现。
- 具体类（Concrete Class）：继承抽象类，实现抽象方法，完成具体步骤的实现。

## 优点

使用模板方法模式的好处是可以在不改变算法结构的情况下，灵活地扩展和变化具体步骤的实现。它也能提高代码的复用性和可维护性，将公共的代码逻辑放在抽象类中，避免了重复的代码。

## 缺点

模板方法模式可能会导致类的数量增加，同时也可能增加代码的复杂性。因此，在使用时需要权衡代码的可读性和灵活性。

## 适用场景

模板方法模式适用于以下场景：
- 有多个子类，且它们有共同的行为，但各自的具体实现可能不同。
- 需要在不改变算法的整体结构的情况下，对算法的某些步骤进行定制化或扩展。

## 与回调的区别

实际上，回调(callback)也能起到与模板方法模式相同的作用；回调是一种双向调用关系，可以分为同步回调(函数返回之前执行回调函数)和异步回调(函数返回之后执行回调函数，也称为延迟回调)。

从应用场景来看，同步回调看起来很像模板方法模式，异步回调看起来很像观察者模式。

回调基于组合关系实现，把一个对象传递给另一个对象，是一种对象间的关系；模板方法模式基于继承关系实现，子类重写父类的抽象方法，是一种类之间的关系。

组合优于继承，回调比模板方法更加灵活。


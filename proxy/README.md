# 代理模式 Proxy Pattern

允许我们创建一个代理对象，代理对象可以代替原始对象进行一些额外的处理，同时还可以控制对原始对象的访问权限。
实现对对象的控制和管理，同时还可以在不修改原始对象的情况下添加额外的功能。这种解耦和增强的特性使得代理模式在许多应用场景下都非常有用。

用于延迟处理操作或者在进行实际操作前后，进行其它处理等场景。

## 通常在以下情况下使用

1. 远程代理：用于在不同地址空间中访问对象，允许通过网络进行通信。
2. 虚拟代理：用于延迟加载对象，当对象很大或者加载时间较长时，可以通过虚拟代理在需要时才进行加载。
3. 安全代理：用于控制对对象的访问权限，可以在代理对象中添加权限检查逻辑。
4. 智能代理：用于在访问对象时添加额外的功能，例如记录日志、缓存等。
5. 同步代理
6. Cache 代理
7. COW代理：Copy-on-Write（写时复制），通过延迟复制的方式来优化对被代理对象的写操作，提高性能和并发性。

    用于优化被代理对象的写操作。在多线程环境下，通过延迟复制（写操作）来提高性能和并发性。当多个线程需要对被代理对象进行写操作时，COW代理会先创建被代理对象的一个副本（拷贝），而不是直接修改原始对象。这样，每个线程都可以在自己的副本上进行修改，而不会相互干扰。

    只有当某个线程要对副本进行写操作时，COW代理才会执行实际的复制操作，将副本转换为一个独立的对象，从而保持线程间的数据隔离。这种延迟复制的方式可以减少不必要的复制操作，提高性能和并发性。

    常用于需要高效处理共享数据的场景，例如在并发编程中的线程安全集合（如列表、字典）中，可以使用COW代理来实现高效的并发访问。

    需要注意：COW代理适用于多写少读的场景，因为复制操作本身会引入一定的开销。在读操作较多的情况下，COW代理可能不是最优的选择。

8. 防为墙代理

## 包含以下几个角色

1. 抽象主题（Subject）：定义了代理对象和真实对象的共同接口。
2. 真实主题（Real Subject）：定义了真实对象，实现了抽象主题接口。
3. 代理（Proxy）：持有对真实对象的引用，并实现了抽象主题接口。在代理对象中可以进行一些额外的处理，并控制对真实对象的访问。